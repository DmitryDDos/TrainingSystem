@model List<Course>

@{
    Layout = "_Layout";
}

<h1>Список курсов</h1>

@if (User.IsInRole("Admin"))
{
    <p>
        <a class="button" href="@Url.Action("CustomCreate")">Добавить новый курс</a>
    </p>
}

<div class="courses-grid">
    @foreach (var course in Model)
    {
        <article class="course-card">
            <div class="card-image">
                @if (course.CoverImageId.HasValue)
                {
                    <img src="@Url.Content($"/api/File/{course.CoverImageId.Value}")" alt="@course.Title" />
                }
                else
                {
                    <img src="/path/to/default/image.jpg" alt="Нет изображения" />
                }
            </div>
            <div class="card-content">
                <h2 class="card-title">@course.Title</h2>
                <p class="card-description">@course.Description</p>
                <div class="card-actions">
                    @if (User.IsInRole("Admin"))
                    {
                        <a class="edit-button" href="@Url.Action("Edit", new { id = course.Id })">Редактировать</a>
                        <form asp-action="Delete" method="post" onsubmit="return confirm('Удалить курс?')" class="delete-form">
                            <input type="hidden" name="id" value="@course.Id" />
                            <button type="submit" class="delete-button">Удалить</button>
                        </form>
                    }
                    else if (User.Identity.IsAuthenticated) // авторизованный пользователь, не админ
                    {
                        <a class="button start-course" href="@Url.Action("StartCourse", new { id = course.Id })">Начать</a>
                        <form asp-action="AddToFavorites" method="post" class="add-to-favorites-form" style="display:inline;">
                            <input type="hidden" name="courseId" value="@course.Id" />
                            <button type="submit" class="button add-to-favorites">В избранное</button>
                        </form>
                    }
                </div>
            </div>
        </article>
    }
</div>
